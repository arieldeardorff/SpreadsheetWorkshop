---
title: "Designing Spreadsheets that Don't Suck" 
author: "Ariel Deardorff, MLIS <br> Data Services Librarian <br> UCSF Library"
date: "`r Sys.Date()` "

output: 
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      titleSlideClass: ["left", "middle", "inverse"]
---

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_mono_accent(
  base_color = "#058488",
  header_font_google = google_font("Josefin Sans"),
  text_font_google   = google_font("Montserrat", "300", "300i"),
  code_font_google   = google_font("Fira Mono")
)
```

class: center, middle

# Welcome

---

# Learning Objectives 

By the end of this workshop you should be able to:

* Describe best practices for reproducible data organization in spreadsheets
* Design tidy spreadsheets that can be used in a wide variety of data analysis software

---

# Why should I care about spreadsheets?

Spreadsheets are everywhere! 

--

Terrible spreadsheets are everywhere too! 

---

## Messy spreadsheets can have real consequences

--

<br>

![Image of Covid Excel Counting headline](Images/ExcelHeadline.png)

<br>

???
Case study of the British Government 
- Also can't properly load your data into software tools if it isnt formatted properly (Tableau, OpenRefine, SPSS, Python)

---

class: left, middle

## Thankfully there are some simple steps we can take to make our spreadsheets understandable & reproducible!

---

# What should my spreadsheets be called?

Make those file (and variable) names descriptive!

---

```{r, eval= TRUE, echo=FALSE}
knitr::include_graphics("Images/FileNaming.png")
```
source: [Briney, Coates, & Goben, 2020](https://riojournal.com/article/56508/instance/5569704/)

---

```{r, eval= TRUE, echo=FALSE}
knitr::include_graphics("Images/VariableNaming.png")
```

source: [Broman & Woo, 2017](https://www.tandfonline.com/doi/full/10.1080/00031305.2017.1375989)
---

# How should my spreadsheets be structured?

Follow the principles of Tidy Data!

.pull-left[

In Tidy Data:
- Each variable forms a column
- Each observation forms a row
- Each cell is a single measurement]

.pull-right[![tidy data image](Images/TidyDataBasic.png)]

<br>
<br>

Source: [Wickham, 2014](https://www.jstatsoft.org/article/view/v059i10)



---

## Tidy vs Messy Data

![Tidy vs Messy Data](Images/TidyvsMessy.png)
Source: [Lowndes & Horst, 2020](https://docs.google.com/presentation/d/1N7hKepabvl9OrHjvGJWPjUsfzVdB5xzV5AsFndgSwms/edit#slide=id.p)

---

# How should I keep my data coherant?

* Come up with a system and write it down in a data dictionary or read me file!
* Follow the international standard for dates: YYYYMMDD or YYYY-MM-DD or separate dates into columns for month, day, and year
* Have a standard way of marking missing values (NA, NULL, etc) 
* Don't use formatting to encode meaning (highlighted/bolded cells to indicate something)

---

## Activity 2: Critique a messy data spreadsheet

You will have 10 minutes in breakout rooms to critique the COVID spreadsheet.
* What spreadsheet errors do you see?
* How would you design it differently?

Share your ideas in the etherpad and we will discuss as a group.

---

# What else can I do to keep my spreadsheets reproducible?

* Consider using data validation
* Keep your raw data raw - analyze elsewhere
* Save as a plain text file
* Create a backup copy

---

# How do I fix existing messy spreadsheets?
Here are some tools and tutorials you can use if you are forced to work with messy spreadsheets:

* OpenRefine - [tool](https://openrefine.org/), [tutorial](https://arieldeardorff.github.io/OpenRefineWorkshop/index.html) (open source data cleaning software)
* R Tidyverse - [tool](https://www.tidyverse.org/), [tutorial](https://rstudio-conf-2020.github.io/r-for-excel/) (R package for cleaning spreadsheet data)
* Python Pandas - [tool](https://pandas.pydata.org/), [tutorial](https://courses.ucsf.edu/course/view.php?id=5248) 

---

# Learn More

Check out these articles to learn more about tidy data or organizing data in spreadsheets:

Briney KA, Coates H, Goben A (2020) Foundational Practices of Research Data Management. Research Ideas and Outcomes 6: e56508. [https://doi.org/10.3897/rio.6.e56508](https://doi.org/10.3897/rio.6.e56508)

Broman, K. & Woo, K (2018) Data Organization in Spreadsheets, The American Statistician, 72:1, 2-10, DOI: [10.1080/00031305.2017.1375989](https://www.tandfonline.com/doi/full/10.1080/00031305.2017.1375989) 

Wickham, H. (2014). Tidy Data. Journal of Statistical Software, 59(10), 1 - 23. doi:[http://dx.doi.org/10.18637/jss.v059.i10](http://dx.doi.org/10.18637/jss.v059.i10)

---

class: left, middle

# What Questions Do You Have?

---

# References

Briney KA, Coates H, Goben A (2020) Foundational Practices of Research Data Management. Research Ideas and Outcomes 6: e56508. [https://doi.org/10.3897/rio.6.e56508](https://doi.org/10.3897/rio.6.e56508)

Broman, K. & Woo, K (2018) Data Organization in Spreadsheets, The American Statistician, 72:1, 2-10, DOI: [10.1080/00031305.2017.1375989](https://www.tandfonline.com/doi/full/10.1080/00031305.2017.1375989) 

Lowndes, J. & Horst, A. (2020) Tidy Data for Efficiency, Reproducibility, and Collaboration. OpenScapes [https://www.openscapes.org/blog/2020/10/12/tidy-data/](https://www.openscapes.org/blog/2020/10/12/tidy-data/)

Sherry Lake, Tim Dennis, Jez Cope, Francois Michonneau, Christopher Erdmann, erikamias, â€¦ yvonnemery. (2020, July). LibraryCarpentry/lc-spreadsheets: LibraryCarpentry/lc-spreadsheets: Library Carpentry: Tidy data for Librarians, July 2020 (Version v2020.07.1). Zenodo. [http://doi.org/10.5281/zenodo.3954067](http://doi.org/10.5281/zenodo.3954067)

Wickham, H. (2014). Tidy Data. Journal of Statistical Software, 59(10), 1 - 23. doi:[http://dx.doi.org/10.18637/jss.v059.i10](http://dx.doi.org/10.18637/jss.v059.i10)

